# CloudBox Internationalization (i18n)

Reference guide for the internationalization system in CloudBox.

---

## Overview

CloudBox uses [react-i18next](https://react.i18next.com/) for internationalization, supporting 6 languages out of the box.

**Supported Languages:**
| Code | Language | Flag |
|------|----------|------|
| `en` | English | ğŸ‡¬ğŸ‡§ |
| `es` | Spanish | ğŸ‡ªğŸ‡¸ |
| `fr` | French | ğŸ‡«ğŸ‡· |
| `de` | German | ğŸ‡©ğŸ‡ª |
| `it` | Italian | ğŸ‡®ğŸ‡¹ |
| `pt` | Portuguese | ğŸ‡§ğŸ‡· |

---

## File Structure

```
frontend/src/
â”œâ”€â”€ i18n.ts                    # i18n configuration
â””â”€â”€ locales/
    â”œâ”€â”€ en/
    â”‚   â””â”€â”€ common.json        # English translations
    â”œâ”€â”€ es/
    â”‚   â””â”€â”€ common.json        # Spanish translations
    â”œâ”€â”€ fr/
    â”‚   â””â”€â”€ common.json        # French translations
    â”œâ”€â”€ de/
    â”‚   â””â”€â”€ common.json        # German translations
    â”œâ”€â”€ it/
    â”‚   â””â”€â”€ common.json        # Italian translations
    â””â”€â”€ pt/
        â””â”€â”€ common.json        # Portuguese translations
```

---

## Configuration

The i18n system is initialized in `frontend/src/i18n.ts`:

```typescript
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import LanguageDetector from 'i18next-browser-languagedetector';

i18n
  .use(LanguageDetector)
  .use(initReactI18next)
  .init({
    supportedLngs: ['en', 'es', 'fr', 'de', 'it', 'pt'],
    fallbackLng: 'en',
    ns: ['common'],
    defaultNS: 'common',
    detection: {
      order: ['localStorage', 'navigator', 'htmlTag'],
      caches: ['localStorage'],
      lookupLocalStorage: 'cloudbox-language',
    },
  });
```

**Detection Order:**
1. `localStorage` (persisted preference)
2. Browser language (`navigator.language`)
3. HTML `lang` attribute

---

## Using Translations

### In React Components

```tsx
import { useTranslation } from 'react-i18next';

function MyComponent() {
  const { t } = useTranslation();
  
  return (
    <div>
      <h1>{t('dashboard.title')}</h1>
      <p>{t('dashboard.welcome', { name: 'John' })}</p>
    </div>
  );
}
```

### With Interpolation

Translation file:
```json
{
  "dashboard": {
    "welcome": "Welcome, {{name}}!",
    "files": "You have {{count}} file",
    "files_plural": "You have {{count}} files"
  }
}
```

Component:
```tsx
{t('dashboard.welcome', { name: user.name })}
{t('dashboard.files', { count: files.length })}
```

### Pluralization

i18next handles plurals automatically based on the `count` parameter:

```json
{
  "item": "{{count}} item",
  "item_plural": "{{count}} items"
}
```

---

## Adding a New Language

### 1. Create Translation File

Create a new directory in `frontend/src/locales/`:

```bash
mkdir frontend/src/locales/ja
touch frontend/src/locales/ja/common.json
```

### 2. Copy English as Base

```bash
cp frontend/src/locales/en/common.json frontend/src/locales/ja/common.json
```

### 3. Translate Content

Edit `common.json` with translated strings:

```json
{
  "common": {
    "save": "ä¿å­˜",
    "cancel": "ã‚­ãƒ£ãƒ³ã‚»ãƒ«",
    "delete": "å‰Šé™¤"
  }
}
```

### 4. Register Language

Update `frontend/src/i18n.ts`:

```typescript
// Import the new translations
import jaCommon from './locales/ja/common.json';

// Add to resources
const resources = {
  en: { common: enCommon },
  es: { common: esCommon },
  // ...existing languages
  ja: { common: jaCommon },  // Add this
};

// Update supportedLngs
i18n.init({
  supportedLngs: ['en', 'es', 'fr', 'de', 'it', 'pt', 'ja'],
  // ...
});
```

### 5. Add to Language Selector

Update `frontend/src/components/LanguageSelector.tsx`:

```typescript
const languages = [
  { code: 'en', name: 'English', flag: 'ğŸ‡¬ğŸ‡§' },
  { code: 'es', name: 'EspaÃ±ol', flag: 'ğŸ‡ªğŸ‡¸' },
  // ...existing languages
  { code: 'ja', name: 'æ—¥æœ¬èª', flag: 'ğŸ‡¯ğŸ‡µ' },
];
```

---

## Translation Keys Structure

The translation files are organized by namespace and feature:

```json
{
  "common": {
    "save": "Save",
    "cancel": "Cancel",
    "delete": "Delete",
    "loading": "Loading..."
  },
  "auth": {
    "login": "Login",
    "logout": "Logout",
    "register": "Register",
    "password": "Password"
  },
  "files": {
    "upload": "Upload",
    "download": "Download",
    "rename": "Rename",
    "move": "Move to..."
  },
  "dashboard": {
    "title": "Dashboard",
    "recentFiles": "Recent Files",
    "storageUsed": "Storage Used"
  }
}
```

---

## Changing Language Programmatically

```typescript
import { useTranslation } from 'react-i18next';

function LanguageSwitcher() {
  const { i18n } = useTranslation();
  
  const changeLanguage = (code: string) => {
    i18n.changeLanguage(code);
    // Persisted automatically to localStorage
  };
  
  return (
    <select onChange={(e) => changeLanguage(e.target.value)}>
      <option value="en">English</option>
      <option value="es">EspaÃ±ol</option>
    </select>
  );
}
```

---

## Getting Current Language

```typescript
import { useTranslation } from 'react-i18next';

function MyComponent() {
  const { i18n } = useTranslation();
  
  console.log(i18n.language); // 'en', 'es', etc.
}
```

---

## Date & Number Formatting

For locale-aware formatting, use the native `Intl` APIs:

```typescript
const { i18n } = useTranslation();

// Format dates
const date = new Date();
const formattedDate = new Intl.DateTimeFormat(i18n.language).format(date);

// Format numbers
const bytes = 1048576;
const formattedNumber = new Intl.NumberFormat(i18n.language).format(bytes);

// Format file sizes (custom helper)
import { formatBytes } from '../lib/utils';
const size = formatBytes(bytes, i18n.language);
```

---

## Best Practices

### âœ… Do

- Use descriptive, hierarchical keys: `files.upload.button`
- Include context in keys when needed: `files.delete.confirm`
- Add translator comments for ambiguous strings
- Test with long translations (German is often 30% longer)

### âŒ Don't

- Don't hardcode strings in components
- Don't concatenate translated strings
- Don't use translation keys as fallback values
- Don't forget to update all language files when adding keys

---

## Debugging

Enable debug mode in development:

```typescript
i18n.init({
  debug: import.meta.env.DEV,
  // ...
});
```

This will log missing keys and other i18n issues to the console.

---

## Missing Translations

If a key is missing, i18next will:
1. Look for the key in the fallback language (`en`)
2. Return the key itself if not found

To find missing translations:
```bash
# Run the app in development mode and check console for warnings
npm run dev
```
