# ================================
# CloudBox - Production Environment Variables
# ================================
# Copy this file to .env and fill in all required values
# Required values are marked with [REQUIRED]
# ================================

# [REQUIRED] Full frontend URL (with https://)
FRONTEND_URL=https://cloud.example.com

# ============ TRUSTED PROXY ============
# Express trust proxy setting (set when behind reverse proxies)
TRUST_PROXY=loopback, linklocal, uniquelocal

# ============ DATABASE ============
# PostgreSQL credentials
POSTGRES_USER=cloudbox
# [REQUIRED] Strong password for PostgreSQL
POSTGRES_PASSWORD=your-super-secret-postgres-password
POSTGRES_DB=cloudbox

# ============ REDIS ============
# Password for Redis (optional but recommended)
REDIS_PASSWORD=your-redis-password

# ============ JWT SECRETS ============
# [REQUIRED] Generate with: openssl rand -base64 64
JWT_SECRET=your-super-secret-jwt-key-minimum-32-characters
JWT_REFRESH_SECRET=your-super-secret-refresh-key-minimum-32-characters

# Token expiration times
JWT_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# ============ ENCRYPTION ============
# [REQUIRED] Used to encrypt sensitive data (SMTP passwords, 2FA secrets)
# Generate with: openssl rand -base64 32
ENCRYPTION_KEY=your-unique-encryption-key-minimum-32-characters

# Run Prisma migrations on container startup (true/false)
RUN_MIGRATIONS_ON_START=true

# ============ STORAGE ============
# Maximum single file size in bytes (default: 100MB)
MAX_FILE_SIZE=1073741824

# Default storage quota per user in bytes (default: 5GB)
DEFAULT_QUOTA=5368709120

# Days to keep deleted files in trash (default: 30)
TRASH_RETENTION_DAYS=30

# ============ MIDI RENDERING ============
# Container path to a GM soundfont (.sf2) for MIDI -> MP3 rendering
MIDI_SOUNDFONT_PATH=/app/assets/soundfonts/FluidR3_GM.sf2

# Container path to the FluidSynth binary
MIDI_FLUIDSYNTH_PATH=/usr/bin/fluidsynth

# Optional render tuning
MIDI_SAMPLE_RATE=44100
MIDI_GAIN=1.0
MIDI_MP3_QUALITY=2
MIDI_RENDER_TIMEOUT_MS=300000

# ============ SMTP (Optional) ============
# Email server configuration for notifications
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
SMTP_FROM=CloudBox <noreply@example.com>

# ============ FILE PERMISSIONS ============
# UID/GID for the cloudbox user (matches backend Dockerfile user)
CLOUDBOX_UID=1001
CLOUDBOX_GID=1001

# UID/GID for postgres:16-alpine (verify with: docker run --rm postgres:16-alpine id -u postgres)
POSTGRES_UID=70
POSTGRES_GID=70

# UID/GID for redis:7-alpine (verify with: docker run --rm redis:7-alpine id -u redis)
REDIS_UID=999
REDIS_GID=999

# ============ DOCKER ============
# Docker registry (leave empty for local builds)
REGISTRY=

# Image version tag
VERSION=latest

# ============ GOOGLE OAUTH (Optional) ============
# Google OAuth credentials for social login
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# ============ INITIAL ADMIN (Optional) ============
# The production Docker image runs migrations on startup, but does NOT run the seed automatically.
# If you want to create the first admin via the seed script, set these and run:
#   docker-compose -f docker-compose.prod.yml exec backend node dist/prisma/seed.js
ADMIN_EMAIL=admin@example.com
# Must be at least 12 characters in production
ADMIN_PASSWORD=change-me-long-random-password

# ============ GLITCHTIP / ERROR TRACKING (Optional) ============
# GlitchTip is a self-hosted Sentry alternative included in docker-compose.prod.yml
# After starting GlitchTip, create organization/project at http://localhost:8000
# and copy the DSN (e.g., http://key@localhost:8000/1)

# [OPTIONAL] Sentry/GlitchTip DSN (leave empty to disable error tracking)
SENTRY_DSN=

# GlitchTip database password
GLITCHTIP_DB_PASSWORD=your-glitchtip-db-password

# [REQUIRED if using GlitchTip] Secret key for GlitchTip
# Generate with: openssl rand -base64 32
GLITCHTIP_SECRET_KEY=your-strong-glitchtip-secret

# GlitchTip domain (for email links)
GLITCHTIP_DOMAIN=http://localhost:8000

# GlitchTip email configuration (uses console by default)
# For Gmail: smtp://user:pass@smtp.gmail.com:587
GLITCHTIP_EMAIL_URL=consolemail://
GLITCHTIP_FROM_EMAIL=noreply@localhost
