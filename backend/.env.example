# Server Configuration
NODE_ENV=development
PORT=3001
FRONTEND_URL=http://localhost:5173

# Database
DATABASE_URL="file:./dev.db"

# JWT Configuration (CHANGE THESE IN PRODUCTION!)
JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-in-production
JWT_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# Storage Configuration
STORAGE_PATH=./data
MAX_FILE_SIZE=104857600
DEFAULT_QUOTA=5368709120

# Trash Configuration
TRASH_RETENTION_DAYS=30

# Google OAuth (optional)
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# SMTP Configuration (optional)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=
SMTP_PASS=
SMTP_FROM=CloudBox <noreply@cloudbox.com>

# ===========================================
# Redis Configuration (optional but recommended)
# ===========================================
# Redis is used for:
# - Caching (folder lists, file metadata, user info)
# - Session store (multi-device tracking, instant logout)
# - Job queues (transcoding, thumbnail generation)
# - Distributed rate limiting (multi-node deployments)
#
# Without Redis, the system falls back to:
# - No caching (more database queries)
# - Database-based sessions
# - In-process job queues with p-limit (competes with API for CPU)
# - In-memory rate limiting (no coordination across nodes)

REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Enable/disable caching (default: true if Redis is available)
CACHE_ENABLED=true

# Maximum concurrent sessions per user (0 = unlimited)
MAX_SESSIONS_PER_USER=10

# ===========================================
# Queue Worker Configuration
# ===========================================
# For production, run the queue worker as a separate process:
#   npx tsx src/workers/queueWorker.ts (development)
#   node dist/workers/queueWorker.js (production)
#
# This isolates ffmpeg/sharp from the API server, preventing
# transcoding from affecting upload/download performance.

# Fallback concurrency when Redis is unavailable (in-process mode)
TRANSCODING_FALLBACK_CONCURRENCY=2
THUMBNAIL_FALLBACK_CONCURRENCY=2

# Bull queue concurrency when Redis is available
TRANSCODING_BULL_CONCURRENCY=2
THUMBNAIL_CONCURRENCY=4

# Rate limiting for thumbnail generation (per user)
THUMBNAIL_RATE_LIMIT_PER_HOUR=1000
THUMBNAIL_RATE_LIMIT_WINDOW_MS=3600000

# Worker-specific settings (for queueWorker.ts)
WORKER_CONCURRENCY=2
WORKER_TYPE=all
